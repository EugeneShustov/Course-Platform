{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container">
  <div class="course-card">
    <h1>{{ course.title }}</h1>
    <p>{{ course.description }}</p>
    <p><strong>Автор:</strong> {{ course.owner.username }}</p>
  </div>

  <h2 style="margin-top: 30px;">Модули курса</h2>
  <ul class="module-list">
    {% for module in course.modules.all %}
      <li class="module-card">
        <h4>{{ module.title }}</h4>

        <form method="post" action="{% url 'mark_module_complete' module.pk %}">
          {% csrf_token %}
          <button type="submit" class="btn-link btn-success">Выполнено</button>
        </form>

        {% if course.owner == user %}
          <form method="post" style="display:inline;">
            {% csrf_token %}
            <input type="hidden" name="delete_module_id" value="{{ module.pk }}">
            <button type="submit" class="btn-link btn-danger" onclick="return confirm('Удалить модуль?');">
              Удалить
            </button>
          </form>
        {% endif %}
      </li>
    {% empty %}
      <li>Модулей ещё нет</li>
    {% endfor %}
  </ul>

  {% if course.owner == user %}
    <div style="margin-top: 30px;">
      <a href="{% url 'edit_course' course.pk %}" class="btn-link">Редактировать курс</a>
      <a href="{% url 'add_module' course.pk %}" class="btn-link" style="margin-left:10px;">Добавить модуль</a>
    </div>
  {% endif %}

  <form method="post" action="{% url 'enroll_course' course.pk %}" style="margin-top: 40px;">
    {% csrf_token %}
    <button type="submit" class="btn-link">Записаться на курс</button>
  </form>
</div>
{% endblock %}

