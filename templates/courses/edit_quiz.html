{% extends 'base.html' %}
{% load dict_extras %}
{% block title %}Редактировать тест{% endblock %}

{% block content %}
<h2>Тест "{{ quiz.title }}"</h2>

{% if messages %}
  <ul class="messages">
    {% for message in messages %}
      <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
  </ul>
{% endif %}

<form method="post">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit" class="btn-link btn-success">Сохранить настройки</button>
</form>

<form action="{% url 'auto_import_and_start_quiz' quiz.id %}" method="post" enctype="multipart/form-data" style="margin-top: 1em;">
  {% csrf_token %}
  {{ import_form.file }}
  <button type="submit" class="btn btn-primary">Импортировать и пройти тест</button>
</form>
<hr>

<h3>Состав теста:</h3>
<ul>
  {% for question in quiz.questions.all %}
    <li style="margin-bottom: 20px;">
      <h4>{{ question.text }}</h4>
      <ul>
        {% for answer in question.answers.all %}
          <li>
            {{ answer.text }}
            {% if answer.is_correct %}
              <strong style="color: green;">Правильный</strong>
            {% endif %}
          </li>
        {% empty %}
          <li style="color: red;">Нет ни одного ответа</li>
        {% endfor %}
      </ul>
      {% if not question_flags|dict_get:question.id %}
        <span style="color: red;">Нет правильного ответа</span>
      {% endif %}
    </li>
  {% empty %}
    <li style="color: gray;">Вопросы не добавлены</li>
  {% endfor %}
</ul>
{% endblock %}




